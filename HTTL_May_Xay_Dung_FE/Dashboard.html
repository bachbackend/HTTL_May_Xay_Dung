<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
	<meta name="author" content="AdminKit">
	<meta name="keywords" content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">

	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link rel="shortcut icon" href="./dashboard/img/icons/icon-48x48.png" />

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


	<title>Dashboard</title>

	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&amp;display=swap" rel="stylesheet">

	<!-- Choose your prefered color scheme -->
	<!-- <link href="css/light.css" rel="stylesheet"> -->
	<!-- <link href="css/dark.css" rel="stylesheet"> -->

	<!-- BEGIN SETTINGS -->
	<!-- Remove this after purchasing -->
	<link class="js-stylesheet" href="./dashboard/css/light.css" rel="stylesheet">
	<!-- <script src="./dashboard/js/settings.js"></script>
	<style>body {
			opacity: 0;
		}
	</style> -->
	<!-- END SETTINGS -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120946860-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-120946860-10', { 'anonymize_ip': true });
</script> -->
</head>
<!--
  HOW TO USE: 
  data-theme: default (default), dark, light, colored
  data-layout: fluid (default), boxed
  data-sidebar-position: left (default), right
  data-sidebar-layout: default (default), compact
-->
  <!-- Modal -->
<div class="modal fade" id="addCategoryModal" tabindex="-1" aria-labelledby="addCategoryLabel" aria-hidden="true">
	<div class="modal-dialog">
	  <div class="modal-content">
		<form id="addCategoryForm">
		  <div class="modal-header">
			<h5 class="modal-title" id="addCategoryLabel">Th√™m Danh M·ª•c S·∫£n Ph·∫©m</h5>
			<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
		  </div>
		  <div class="modal-body">
			<div class="mb-3">
			  <label for="name" class="form-label">T√™n danh m·ª•c</label>
			  <input type="text" id="name" class="form-control" required placeholder="Nh·∫≠p t√™n danh m·ª•c">
			</div>
			<div class="mb-3">
			  <label for="parentId" class="form-label">Danh m·ª•c cha</label>
			  <select id="parentId" class="form-select">
				<option value="">-- Kh√¥ng c√≥ (Danh m·ª•c g·ªëc) --</option>
			  </select>
			</div>
			<div id="message" class="mt-2"></div>
		  </div>
		  <div class="modal-footer">
			<button type="submit" class="btn btn-primary">Th√™m</button>
			<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
		  </div>
		</form>
	  </div>
	</div>
  </div>

<body data-theme="default" data-layout="fluid" data-sidebar-position="left" data-sidebar-layout="default">
	<div class="wrapper">
		<nav id="sidebar" class="sidebar js-sidebar">
			<div class="sidebar-content js-simplebar">
				<a class="sidebar-brand" href="Dashboard.html">
					<span class="sidebar-brand-text align-middle">
						Machine Max
						<sup><small class="badge bg-primary text-uppercase">Pro</small></sup>
					</span>
					<svg class="sidebar-brand-icon align-middle" width="32px" height="32px" viewBox="0 0 24 24" fill="none" stroke="#FFFFFF" stroke-width="1.5"
						stroke-linecap="square" stroke-linejoin="miter" color="#FFFFFF" style="margin-left: -3px">
						<path d="M12 4L20 8.00004L12 12L4 8.00004L12 4Z"></path>
						<path d="M20 12L12 16L4 12"></path>
						<path d="M20 16L12 20L4 16"></path>
					</svg>
				</a>

				<div class="sidebar-user">
					<div class="d-flex justify-content-center">
						<div class="flex-shrink-0">
							<img src="./dashboard/img/avatars/avatar.jpg" class="avatar img-fluid rounded me-1" alt="Charles Hall" />
						</div>
						<div class="flex-grow-1 ps-2" id="user-profile-section">
							<a class="sidebar-user-title dropdown-toggle" href="#" data-bs-toggle="dropdown" id="user-name">
							</a>
							<div class="dropdown-menu dropdown-menu-start">
								<a class="dropdown-item" id="open-profile"><i class="align-middle me-1" data-feather="user"></i> Profile</a>
								

							</div>
						
							<div class="sidebar-user-subtitle" id="user-role"></div>
						</div>
						
					</div>
				</div>

				<ul class="sidebar-nav">
					<li class="sidebar-item">
						<a class="sidebar-link" href="Product-Management.html">
							<i class="align-middle" data-feather="box"></i> <span class="align-middle">Qu·∫£n l√Ω s·∫£n ph·∫©m</span>
						</a>
					</li>

					<li class="sidebar-item">
						<a class="sidebar-link" href="Article-Management.html">
							<i class="align-middle" data-feather="edit"></i> <span class="align-middle">Qu·∫£n l√Ω b√†i vi·∫øt</span>
						</a>
					</li>

					<li class="sidebar-item">
						<a class="sidebar-link" href="Contact-Management.html">
							<i class="align-middle" data-feather="user"></i> <span class="align-middle">Qu·∫£n l√Ω li√™n h·ªá</span>
						</a>
					</li>

					<li class="sidebar-item">
						<a class="sidebar-link" href="Order-Management.html">
							<i class="align-middle" data-feather="shopping-cart"></i> <span class="align-middle">Qu·∫£n l√Ω ƒë∆°n h√†ng</span>
						</a>
					</li>

					<!-- <li class="sidebar-item">
						<a class="sidebar-link" href="Add-Category.html">
							<i class="align-middle" data-feather="calendar"></i> <span class="align-middle">Th√™m danh m·ª•c s·∫£n ph·∫©m</span>
						</a>
					</li> -->
					<li class="sidebar-item">
						<a class="sidebar-link" href="#" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
						  <i class="align-middle" data-feather="folder"></i>
						  <span class="align-middle">Th√™m danh m·ª•c s·∫£n ph·∫©m</span>
						</a>
					  </li>

					<li class="sidebar-item">
						<a class="dropdown-item" href="#" id="logout-button">Log out</a>
					</li>


					
				</ul>

				
			</div>

			<script>
				document.getElementById("logout-button").addEventListener("click", function () {
					// X√≥a th√¥ng tin ng∆∞·ªùi d√πng kh·ªèi localStorage
					localStorage.removeItem("accesstoken");
			
					// C√≥ th·ªÉ x√≥a th√™m token ho·∫∑c d·ªØ li·ªáu li√™n quan n·∫øu c√≥
					// localStorage.removeItem("authToken");
			
					// Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang ƒëƒÉng nh·∫≠p
					window.location.href = "Login.html"; // Thay b·∫±ng ƒë∆∞·ªùng d·∫´n ƒë√∫ng t·ªõi trang ƒëƒÉng nh·∫≠p c·ªßa b·∫°n
				});
			</script>
			
		</nav>

		<div class="main">
			<nav class="navbar navbar-expand navbar-light navbar-bg">
				<a class="sidebar-toggle js-sidebar-toggle">
					<i class="hamburger align-self-center"></i>
				</a>

				<form class="d-none d-sm-inline-block">
					<div class="input-group input-group-navbar">
						<input type="text" class="form-control" placeholder="Search‚Ä¶" aria-label="Search">
						<button class="btn" type="button">
							<i class="align-middle" data-feather="search"></i>
						</button>
					</div>
				</form>

			</nav>

			<main class="content">
				<div class="container-fluid p-0">

					<div class="row mb-2 mb-xl-3">
						<div class="col-auto d-none d-sm-block">
							<h3><strong>Analytics</strong> Dashboard</h3>
						</div>
					</div>
					<div class="row">
						<div class="col-xl-6 col-xxl-5 d-flex">
							<div class="w-100">
								<div class="row">
									<div class="col-sm-6">
										<div class="card">
											<div class="card-body">
												<div class="row">
													<div class="col mt-0">
														<h5 class="card-title">S·ªë l∆∞·ª£ng s·∫£n ph·∫©m</h5>
													</div>

													<div class="col-auto">
														<div class="stat text-primary">
															<i class="align-middle" data-feather="box"></i>
														</div>
													</div>
												</div>
												<h1 class="mt-1 mb-3" id="product-count">Loading...</h1>
												<!-- <div class="mb-0">
													<span class="badge badge-primary-light"> <i class="mdi mdi-arrow-bottom-right"></i> -3.65% </span>
													<span class="text-muted">Since last week</span>
												</div> -->
											</div>
										</div>
										<div class="card">
											<div class="card-body">
												<div class="row">
													<div class="col mt-0">
														<h5 class="card-title">T·ªïng s·ªë ng∆∞·ªùi d√πng</h5>
													</div>

													<div class="col-auto">
														<div class="stat text-primary">
															<i class="align-middle" data-feather="users"></i>
														</div>
													</div>
												</div>
												<h1 class="mt-1 mb-3" id="user-count">Loading...</h1>
												<!-- <div class="mb-0">
													<span class="badge badge-success-light"> <i class="mdi mdi-arrow-bottom-right"></i> 5.25% </span>
													<span class="text-muted">Since last week</span>
												</div> -->
											</div>
										</div>
									</div>
									<div class="col-sm-6">
										<div class="card">
											<div class="card-body">
												<div class="row">
													<div class="col mt-0">
														<h5 class="card-title">S·ªë l∆∞·ª£ng b√†i vi·∫øt</h5>
													</div>

													<div class="col-auto">
														<div class="stat text-primary">
															<i class="align-middle" data-feather="book"></i>
														</div>
													</div>
												</div>
												<h1 class="mt-1 mb-3" id="article-count">Loading...</h1>
												<!-- <div class="mb-0">
													<span class="badge badge-success-light"> <i class="mdi mdi-arrow-bottom-right"></i> 6.65% </span>
													<span class="text-muted">Since last week</span>
												</div> -->
											</div>
										</div>
										<div class="card">
											<div class="card-body">
												<div class="row">
													<div class="col mt-0">
														<h5 class="card-title">T·ªïng s·ªë ƒë∆°n h√†ng</h5>
													</div>

													<div class="col-auto">
														<div class="stat text-primary">
															<i class="align-middle" data-feather="shopping-cart"></i>
														</div>
													</div>
												</div>
												<h1 class="mt-1 mb-3" id="order-count">Loading...</h1>

												<!-- <div class="mb-0">
													<span class="badge badge-danger-light"> <i class="mdi mdi-arrow-bottom-right"></i> -2.25% </span>
													<span class="text-muted">Since last week</span>
												</div> -->
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="col-xl-6 col-xxl-7">
							<div class="card flex-fill w-100">
								<div class="card-header">
									<div class="float-end">
										<!-- abc -->
									</div>
									<h5 class="card-title mb-0">T·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m</h5>
								</div>
								<div class="card-body pt-2 pb-3">
									<div class="chart chart-sm">


										<div class="train-slider-container">
  <div class="track">
    <div class="rail"></div>
    <div class="train-icon" id="trainIcon">üöÜ</div>
  </div>
  <input type="range" min="0" max="100" value="0" class="train-slider" id="downloadSlider">
  <div class="progress-label" id="progressLabel">0%</div>
  <div class="train-status" id="sliderStatus">K√©o t√†u üöÜ ƒë·∫øn cu·ªëi ƒë∆∞·ªùng ray ƒë·ªÉ t·∫£i CSV</div>
</div>
<style>
	.train-slider-container {
  width: 90%;
  max-width: 600px;
  margin: 50px auto;
  position: relative;
  text-align: center;
}

.track {
  position: relative;
  height: 60px;
  background: transparent;
  margin-bottom: 20px;
}

.rail {
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 8px;
  background: #444;
  transform: translateY(-50%);
  border-radius: 4px;
  z-index: 1;
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);
}

.train-icon {
  position: absolute;
  top: -25px;
  font-size: 30px;
  z-index: 5;
  transition: left 0.1s ease;
  filter: drop-shadow(0 2px 3px rgba(0,0,0,0.4));
  pointer-events: auto;
}

.train-slider {
	left: 0px;
  width: 100%;
  -webkit-appearance: none;
  background: transparent;
  position: absolute;
  top: 20px;
  height: 20px;
  z-index: 3;
  cursor: pointer;
}

.train-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 0;
  height: 0;
}

.train-status {
  margin-top: 10px;
  font-size: 14px;
  color: #333;
}

</style>


									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-12 col-md-12 col-xxl-9 d-flex order-3 order-xxl-2">
							<div class="card flex-fill w-100">
								<div class="card-header">
									<div class="card-actions float-end">
										<div class="dropdown position-relative">
											<a href="#" data-bs-toggle="dropdown" data-bs-display="static">
												<i class="align-middle" data-feather="more-horizontal"></i>
											</a>

											<div class="dropdown-menu dropdown-menu-end">
												<a class="dropdown-item" href="#">Action</a>
												<a class="dropdown-item" href="#">Another action</a>
												<a class="dropdown-item" href="#">Something else here</a>
											</div>
										</div>
									</div>
									<h5 class="card-title mb-0">L∆∞u ƒë∆°n h√†ng </h5>
								</div>


								 <div class="input-section">
    <label for="startDate">T·ª´ ng√†y:</label>
    <input type="date" id="startDate">
    <label for="endDate">ƒê·∫øn ng√†y:</label>
    <input type="date" id="endDate">
  </div>


								<div class="slider-container">
  <div class="rail"></div>
  <div class="train-icon" id="orderTrainIcon">üöÜ</div>
  <input type="range" min="0" max="100" value="0" class="train-slider" id="orderTrainSlider">
  <div class="progress-label" id="orderProgressLabel">0%</div>
</div>
<style>
	.slider-container {
  position: relative;
  width: 100%;
  height: 80px;
  margin: 30px auto;
}

.rail {
  position: absolute;
  top: 50%;
  left: 0;
  height: 10px;
  width: 100%;
  background: repeating-linear-gradient(90deg, #ccc, #ccc 10px, #999 10px, #999 20px);
  border-radius: 5px;
  transform: translateY(-50%);
  z-index: 1;
}

.train-slider {
  width: 100%;
  -webkit-appearance: none;
  background: transparent;
  position: absolute;
  top: 30px;
  height: 30px;
  z-index: 3;
  cursor: pointer;
}

.train-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  background: transparent;
  border: none;
}

.train-icon {
  position: absolute;
  top: -5px;
  font-size: 30px;
  z-index: 5;
  transition: left 0.1s ease;
  pointer-events: none;
}

.progress-label {
  position: absolute;
  top: -30px;
  font-weight: bold;
  font-size: 14px;
  color: #333;
  z-index: 6;
}

</style>
							</div>
						</div>
						<div class="col-12 col-md-6 col-xxl-3 d-flex order-2 order-xxl-1">
							<div class="card flex-fill">
								<div class="card-header">
									<div class="card-actions float-end">
										<div class="dropdown position-relative">
											<a href="#" data-bs-toggle="dropdown" data-bs-display="static">
												<i class="align-middle" data-feather="more-horizontal"></i>
											</a>

											<div class="dropdown-menu dropdown-menu-end">
												<a class="dropdown-item" href="#">Action</a>
												<a class="dropdown-item" href="#">Another action</a>
												<a class="dropdown-item" href="#">Something else here</a>
											</div>
										</div>
									</div>
									<h5 class="card-title mb-0">Calendar</h5>
								</div>
								<div class="card-body d-flex">
									<div class="align-self-center w-100">
										<div class="chart">
											<div id="datetimepicker-dashboard"></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

			</main>

		</div>
	</div>

	<script>

		const orderSlider = document.getElementById('orderTrainSlider');
    const orderTrainIcon = document.getElementById('orderTrainIcon');
    const orderProgressLabel = document.getElementById('orderProgressLabel');

    const startDateInput = document.getElementById('startDate');
    const endDateInput = document.getElementById('endDate');

    orderSlider.addEventListener('input', () => {
      const value = parseInt(orderSlider.value);
      const max = parseInt(orderSlider.max);
      const percentage = (value / max) * 100;

      orderTrainIcon.style.left = `calc(${percentage}% - 15px)`;
      orderProgressLabel.textContent = `${value}%`;
      orderProgressLabel.style.left = `calc(${percentage}% - 10px)`;

      if (value >= 36) {
        orderTrainIcon.style.filter = 'drop-shadow(0 0 10px green)';
      } else {
        orderTrainIcon.style.filter = 'drop-shadow(0 2px 3px rgba(0,0,0,0.4))';
      }

      if (value >= 100) {
        const startDate = startDateInput.value;
        const endDate = endDateInput.value;

        if (!startDate || !endDate) {
          alert('Vui l√≤ng ch·ªçn c·∫£ ng√†y b·∫Øt ƒë·∫ßu v√† k·∫øt th√∫c!');
          resetSlider();
          return;
        }

        fetch(`https://localhost:7205/api/Order/GetCSVFile?startDate=${startDate}&endDate=${endDate}`)
          .then(response => response.blob())
          .then(blob => {
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'orders.csv';
            document.body.appendChild(a);
            a.click();
            a.remove();
            window.URL.revokeObjectURL(url);
            resetSlider();
          })
          .catch(err => {
            alert('L·ªói khi t·∫£i CSV ƒë∆°n h√†ng: ' + err);
            resetSlider();
          });
      }
    });

    function resetSlider() {
      setTimeout(() => {
        orderSlider.value = 0;
        orderTrainIcon.style.left = `-15px`;
        orderProgressLabel.textContent = `0%`;
        orderProgressLabel.style.left = `-10px`;
      }, 500);
    }
	</script>
    <script>
		document.addEventListener("DOMContentLoaded", function() {
			var date = new Date(Date.now());
			var defaultDate = date.getUTCFullYear() + "-" + (date.getUTCMonth() + 1) + "-" + date.getUTCDate();
			document.getElementById("datetimepicker-dashboard").flatpickr({
				inline: true,
				prevArrow: "<span class=\"fas fa-chevron-left\" title=\"Previous month\"></span>",
				nextArrow: "<span class=\"fas fa-chevron-right\" title=\"Next month\"></span>",
				defaultDate: defaultDate
			});
		});
	</script>



<script>


const slider = document.getElementById('downloadSlider');
const train = document.getElementById('trainIcon');
const status = document.getElementById('sliderStatus');

let isDownloading = false;

slider.addEventListener('input', async function () {
  const value = parseInt(slider.value);

  // Di chuy·ªÉn t√†u
  const trackWidth = slider.offsetWidth;
  const trainPosition = (value / 100) * (trackWidth - 30); // 30 is icon width buffer
  train.style.left = `${trainPosition}px`;

  // Hi·ªáu ·ª©ng s√°ng khi >= 36%
  if (value >= 36) {
    train.style.filter = 'drop-shadow(0 0 8px #00f)';
  } else {
    train.style.filter = 'drop-shadow(0 2px 3px rgba(0,0,0,0.4))';
  }

  // Khi ƒë·∫°t 100%, t·∫£i file
  if (value === 100 && !isDownloading) {
    isDownloading = true;
    status.textContent = 'üöÜ ƒêang t·∫£i file CSV...';

    try {
      const response = await fetch('https://localhost:7205/api/Product/GetCSVFile', {
        method: 'GET',
        headers: { 'accept': '*/*' }
      });

      if (!response.ok) throw new Error('L·ªói t·∫£i file');

      const blob = await response.blob();
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'products.csv';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);

      status.textContent = '‚úÖ T·∫£i th√†nh c√¥ng!';
    } catch (error) {
      status.textContent = '‚ùå L·ªói khi t·∫£i: ' + error.message;
    } finally {
      setTimeout(() => {
        slider.value = 0;
        train.style.left = '0px';
        train.style.filter = 'drop-shadow(0 2px 3px rgba(0,0,0,0.4))';
        status.textContent = 'üöÜ K√©o t√†u ƒë·∫øn cu·ªëi ƒë∆∞·ªùng ray ƒë·ªÉ t·∫£i CSV';
        isDownloading = false;
      }, 2000);
    }
  }
});




	let currentUser = null;

	document.addEventListener("DOMContentLoaded", async function () {

		function getUserIdFromToken() {
        const token = localStorage.getItem("accesstoken");
        if (!token) {
            console.warn("Kh√¥ng c√≥ token");
            return null;
        }

        try {
            const payload = JSON.parse(atob(token.split(".")[1]));
            return payload.nameid;
        } catch (error) {
            console.error("L·ªói khi gi·∫£i m√£ token:", error);
            return null;
        }
    }

		const userId = getUserIdFromToken(); // L·∫•y t·ª´ localStorage

		if (!userId) {
			console.error("Kh√¥ng t√¨m th·∫•y userId trong localStorage.");
			window.location.href = "/Login.html";
			return;
		}

		try {
			const res = await fetch(`https://localhost:7205/api/Profile/Profile/${userId}`);
			if (!res.ok) throw new Error("Kh√¥ng th·ªÉ t·∫£i th√¥ng tin ng∆∞·ªùi d√πng");

			const user = await res.json();
			currentUser = user;

			// Ki·ªÉm tra quy·ªÅn truy c·∫≠p dashboard
			if (window.location.pathname.includes("Dashboard.html") && user.role !== 0 && user.role !== 2) {
				alert("B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p v√†o trang n√†y.");
				window.location.href = "/Home.html"; // Chuy·ªÉn h∆∞·ªõng v·ªÅ trang ch·ªß ho·∫∑c trang ph√π h·ª£p
				return;
			}

			// G√°n t√™n v√† vai tr√≤ v√†o UI
			document.getElementById("user-name").textContent = user.username;
			document.getElementById("user-role").textContent = mapRoleToText(user.role);
		} catch (err) {
			console.error("L·ªói khi l·∫•y th√¥ng tin ng∆∞·ªùi d√πng:", err);
			window.location.href = "/Login.html";
		}
	});

	// Khi click "Profile"
	document.getElementById("open-profile").addEventListener("click", function () {
		if (!currentUser) return;

		document.getElementById("modal-username").textContent = currentUser.username;
		document.getElementById("modal-email").textContent = currentUser.email;
		document.getElementById("modal-phone").textContent = currentUser.phonenumber;
		document.getElementById("modal-role").textContent = mapRoleToText(currentUser.role);
		document.getElementById("modal-lastlogin").textContent = currentUser.lastLogin
			? new Date(currentUser.lastLogin).toLocaleString()
			: "Ch∆∞a ƒëƒÉng nh·∫≠p";

		const modal = new bootstrap.Modal(document.getElementById("userProfileModal"));
		modal.show();
	});

	function mapRoleToText(role) {
		switch (role) {
			case 0: return "Admin";
			case 1: return "Kh√°ch h√†ng";
			case 2: return "Manager";
			default: return "Kh√¥ng r√µ";
		}
	}
	
</script>




	<script src="./dashboard/js/app.js"></script>


	<!-- Modal th√¥ng tin ng∆∞·ªùi d√πng -->
<div class="modal fade" id="userProfileModal" tabindex="-1" aria-labelledby="userProfileModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
	  <div class="modal-content">
		<div class="modal-header">
		  <h5 class="modal-title" id="userProfileModalLabel">Th√¥ng tin ng∆∞·ªùi d√πng</h5>
		  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
		</div>
		<div class="modal-body">
		  <p><strong>T√™n:</strong> <span id="modal-username"></span></p>
		  <p><strong>Email:</strong> <span id="modal-email"></span></p>
		  <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> <span id="modal-phone"></span></p>
		  <p><strong>Vai tr√≤:</strong> <span id="modal-role"></span></p>
		  <p><strong>L·∫ßn ƒëƒÉng nh·∫≠p cu·ªëi:</strong> <span id="modal-lastlogin"></span></p>
		</div>
	  </div>
	</div>
  </div>
  
</body>
<script>
	document.addEventListener('DOMContentLoaded', () => {
	  const parentSelect = document.getElementById('parentId');
	  
	  // Khi m·ªü modal th√¨ load l·∫°i danh m·ª•c
	  const addCategoryModal = document.getElementById('addCategoryModal');
	  addCategoryModal.addEventListener('show.bs.modal', () => {
		parentSelect.innerHTML = '<option value="">-- Kh√¥ng c√≥ (Danh m·ª•c g·ªëc) --</option>';
		fetch('https://localhost:7205/api/Category/GetAll')
        .then(response => response.json())
        .then(data => {
          const select = document.getElementById('parentId');
          data.forEach(cat => {
            if (cat.parentId === null) {
              const option = document.createElement('option');
              option.value = cat.id;
              option.textContent = cat.name;
              select.appendChild(option);
            }
          });
        })
		  .catch(err => {
			document.getElementById('message').innerHTML =
			  `<div class="alert alert-danger">L·ªói t·∫£i danh m·ª•c: ${err.message}</div>`;
		  });
	  }, { once: true });
  
	  // X·ª≠ l√Ω submit
	  document.getElementById('addCategoryForm').addEventListener('submit', (e) => {
		e.preventDefault();
  
		const name = document.getElementById('name').value;
		const parentIdValue = parentSelect.value;
  
		const payload = {
		  name: name,
		  parentId: parentIdValue ? parseInt(parentIdValue) : null
		};
  
		fetch('https://localhost:7205/api/Category/Add', {
		  method: 'POST',
		  headers: {
			'Content-Type': 'application/json',
			'Accept': '*/*'
		  },
		  body: JSON.stringify(payload)
		})
		.then(res => {
		  if (res.ok) {
			document.getElementById('message').innerHTML =
			  `<div class="alert alert-success">Th√™m danh m·ª•c th√†nh c√¥ng!</div>`;
			document.getElementById('addCategoryForm').reset();
		  } else {
			throw new Error("Th√™m th·∫•t b·∫°i");
		  }
		})
		.catch(error => {
		  document.getElementById('message').innerHTML =
			`<div class="alert alert-danger">${error.message}</div>`;
		});
	  });

	  fetch('https://localhost:7205/api/Product/CountProducts')
    .then(response => response.json())
    .then(data => {
      // C·∫≠p nh·∫≠t n·ªôi dung c·ªßa ph·∫ßn t·ª≠ <h1> v·ªõi s·ªë l∆∞·ª£ng s·∫£n ph·∫©m
      document.getElementById('product-count').textContent = data;
    })
    .catch(error => {
      console.error('Error:', error);
      document.getElementById('product-count').textContent = 'Error loading data';
    });

	fetch('https://localhost:7205/api/Article/CountArticles')
    .then(response => response.json())
    .then(data => {
      // C·∫≠p nh·∫≠t n·ªôi dung c·ªßa ph·∫ßn t·ª≠ <h1> v·ªõi s·ªë l∆∞·ª£ng s·∫£n ph·∫©m
      document.getElementById('article-count').textContent = data;
    })
    .catch(error => {
      console.error('Error:', error);
      document.getElementById('article-count').textContent = 'Error loading data';
    });

	fetch('https://localhost:7205/api/Order/CountOrders')
    .then(response => response.json())
    .then(data => {
      // C·∫≠p nh·∫≠t n·ªôi dung c·ªßa ph·∫ßn t·ª≠ <h1> v·ªõi s·ªë l∆∞·ª£ng s·∫£n ph·∫©m
      document.getElementById('order-count').textContent = data;
    })
    .catch(error => {
      console.error('Error:', error);
      document.getElementById('order-count').textContent = 'Error loading data';
    });

	fetch('https://localhost:7205/api/User/CountUsers')
    .then(response => response.json())
    .then(data => {
      // C·∫≠p nh·∫≠t n·ªôi dung c·ªßa ph·∫ßn t·ª≠ <h1> v·ªõi s·ªë l∆∞·ª£ng s·∫£n ph·∫©m
      document.getElementById('user-count').textContent = data;
    })
    .catch(error => {
      console.error('Error:', error);
      document.getElementById('user-count').textContent = 'Error loading data';
    });



	  //end dom content loaded
	});
  </script>
  

</html>